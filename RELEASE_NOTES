we're proud to finally announce the new feature release of darktable, 2.4.0!

as always, please don't use the autogenerated tarball provided by github, but only our tar.xz. the checksum is:

$ sha256sum darktable-2.4.0.tar.xz
??? darktable-2.4.0.tar.xz
$ sha256sum darktable-2.4.0.dmg
??? darktable-2.4.0.dmg
$ sha256sum darktable-2.4.0.exe
??? darktable-2.4.0.exe

Important note: to make sure that darktable can keep on supporting the raw file format for your camera, please help us by visiting https://raw.pixls.us/ and making sure that we have the full raw sample set for your camera under CC0 license!

and the changelog as compared to 2.2.0 can be found below. Some of the fixes might have been backported to the stable 2.2.x series already.

- Updated user manual is coming soon™

## Hell Froze Over
- As you might have read on our [news post](https://www.darktable.org/2017/08/darktable-for-windows/) we finally ported dartkable to Windows and intend to support it in the future. At the moment it's still lacking a few features (for example there is not printing support), has a few limitations (tethering requires special drivers to be installed) and comes with its own set of bugs. But overall we are confident that it's quite usable already and hope you will enjoy it. A very special thanks goes to Peter Budai who finally convinced us to agree to the port and who did most of the work.

## New Features And Changes
- A new module for haze removal
- Show a dialog window that tells when locking the database/library failed
- Don't shade the whole region on the map when searching for a location. Instead just draw a border around it.
- Also in map mode: Clear the search list and map indicators when resetting the search module.
- With OsmGPSMap newer than version 1.1.0 (i.e., anything released after this darktable version) the map will show copyright info.
- Running jobs with a progressbar (mostly import and export) will show that progress bar ontop the window entry in your task bar – if the system supports it. It should work on GNOME, KDE and Windows at least.
- Add bash like string replacement for variables (export, watermark, sesion settings).
- Add a preferences option to ask before removing empty dirs
- The "colorbalance" module got a lot faster, thanks to SSE optimized code
- Make gradient sliders a little more colorful and use them in the white balance module
- Make PNG compression level used for exporting configurable
- On OSX, load single images from command line or via drag&drop in darkroom mode
- Add an option to omit the intermediate tag hierarchy in exported files and only add the last level
- Add undo support for masks and more intelligent grouping of undo steps
- In the watermark module, sort the list of SVG files and omit the file extension
- Support XYZ as a proofing profile
- Add absolute color input as an option to the color look up table module
- Local contrast now got a new slider to set the midtone range
- Blending now allows to display individual channels using false colors
- We also added channel specific blend modes for Lab and RGB color spaces
- The tonecurve module now supports auto colour adjustment in RGB
- You can now choose from pre-defined scheduling profiles for OpenCL
- Speaking of OpenCL, darktable now allows to force-use OpenCL for a specific pixelpipe
- darktable got two new helper scripts (those are not installed by default, grab them from the sources): One to pruge thumbnails that no longer have an associated image in the database, and a second script that uses inotify to watch a folder for new files to open them in a running darktable instance.
- In the curve editors of base curve and tone curve you can now delete nodes with a right click and see coordinates of nodes while editing. You can also use keyboard modifiers ctrl and shift to change the precision of your changes
- Creating a new instance of a module can now be done with a quick click of the middle mouse button on the multi-instance icon
- New darktable installations on computers with more than 8 Gb of memory will now by default use half of that per module
- Several background colors and the brush color are now configurable in the CSS
- The base curve module allows for more control of the exposure fusion feature using the newly added bias slider
- Xmp sidecar files are no longer written to disk when the content didn't actually change. That mostly helps with network storage and backup systems that use files' time stamps
- darktable now allows loading floating point HDR DNGs as written by HDRMERGE
- Some new cameras can bump the ISO level to insane highs. We try to follow as good as we can by no longer limiting it to 51200 in the GUI
- Base curve and the highlights module now support multiple instances and use blending and masks
- Having the`1` key toggle between 1 and 0 stars wasn't very popular with many people. You can disable that extra feature and have it behave like the other rating shortcuts now
- You can decide if you want to be asked before resetting the history stacks of images from the lighttable
- The grain module was slightly changed to have a more pleasing, photographic-paper like appearence
- The local contrast module can now be pushed much further, it also got a new local laplacian mode
- Using the color look up table module you can now convert your images to monochrome, honoring the Helmholtz-Kohlrausch effect
- Some more small improvements were made

## Bugfixes
- Fix the problem with rating images by accident when moving the mouse while typing an image size in the export module
- Fix several oddities in folder and tag mode of the collect module.
- Print mode's color profile settings now longer interact with the export module
- Update the style lists when importing a style
- Fix some bugs with multiple module instances used in a style
- On OSX only the main window should be fullscreen, not the popups
- Some speedups with VERY big libraries or having A LOT OF tags
- Significantly speed up tagging many images
- Fix searching locations using Openstreetmap
- Fix partial copies of large files in "import from camera"
- Fix a crash in the import dialog when using Lua to add widgets there
- Fix some false-positive warnings about another running darktable instance and it having locked the databases
- No longer switch to the favourite modules group when duplicating one of its modules
- Fix loading of XYZ files
- Fix Lab export when the profile was set from the lighttable
- Create tmp snapshot files with mode 0600 to stop other people looking at them
- Fix several bugs with Wayland. However, there are still issues, so darktable will prefer XWayland
- Google deprecated the Picasa Web API so it's no longer possible to create G+ albums
- Fix the default for sliders with target not being "red" in the channel mixer
- Fix the removing of directories
- Make the escape key cancel history dialogs
- Block keyboard accels when editing camera controls
- Properly delete XMP sidecars
- Make sure that the rating set in darktable is used for the exported file, not something set inside the raw file
- Don't re-write all XMP files when detaching a tag
- Sync XMPs when a tag is removed from the database
- Sync XMPs after a tag is attached/detached via the Lua API
- Many more bugs got fixed

## Lua
- darktable now uses Lua 5.3. The bundled copy got updated accordingly
- Add dt.print_log. It's like print_error but without the ERROR prefix
- Reorder callback parameters for intermediate export image: add the actual image to the parameters of the event
- Call lua post-import-image event synchronously
- Add darktable.configuration.running_os to detect the OS darktable is running on

## Updated Translations
- Dutch
- French
- German
- Hebrew
- Russian
- Spanish
