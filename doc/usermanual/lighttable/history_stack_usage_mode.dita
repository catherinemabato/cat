<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN"
"topic.dtd">
<topic id="history_stack_usage_mode" xml:lang="en-us">
  <title>mode</title>
  <body>
    <p>This setting defines how a new history stack behaves when pasted on an image that already has a history stack. In simple terms the 
    <q>overwrite</q>mode deletes the previous history stack, whereas 
    <q>append</q>will concatenate the two history stacks.</p>
    <p>A copied history stack can have multiple entries of the same module either with the same name (see 
    <xref href="../darkroom/history.dita#history" type="topic">History stack</xref>) or with different names (see 
    <xref href="../darkroom/multiple_instances.dita#multiple_instances" type="topic">Multiple instances</xref>) and pasting behaves differently depending on the mode setting. On append mode, modules from the source image will be merged into the destination image in the following way: for each copied module of the source image, if there is a module in the destination image with the same name it will replace it. If there is not a such module, a new instance will be created. In both cases the instance is placed on top of the history stack. The 
    <q>copy all</q>/
    <q>paste all</q>action with this mode will only copy the respective last instance of all modules with the same name to the source image.</p>
    <p>In overwrite mode the behavior is the same except that the history of the destination image is deleted before the paste operation. The 
    <q>copy all</q>/
    <q>paste all</q>action with this mode works differently; it will make an exact duplicate of the source image history to the destination image with all instances of all names of the modules.</p>
    <note>if you use 
    <q>overwrite</q>mode to paste history stack entries to the images that wasn't opened in darkroom previously, i.e. the automatic module presets weren't already applied to the image, next time you open said image in darkroom, the automatic presets will be applied to the image. So it may seem as if the 
    <q>overwrite</q>mode did not actually override the existing history stack, but in fact it did override it, and the rest was added later.</note>
    <note type="caution">Caution: only in 
    <q>append</q>mode you keep the option to later reconstruct your existing history stack whereas in 
    <q>overwrite</q>mode your previous edit gets irrevocably lost. Beware, the setting of this parameter remains effective when you quit darktable.</note>
  </body>
</topic>
